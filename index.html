<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>åœ–ç‰‡æª¢æŸ¥å·¥å…· Image Inspection Tool</title>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:20px}
h1,h2,h3{margin-top:24px;line-height:1.25}
.small-en{display:block;font-size:.75em;color:#555}
#dropZone{border:3px dashed #444;padding:36px;text-align:center;font-size:18px;margin-bottom:16px;cursor:pointer}
#dropZone.dragover{background:#f0f0f0}
.controls{margin-bottom:20px}
.controls button{margin-right:8px}
.section{margin-bottom:48px;padding-bottom:16px;border-bottom:1px dashed #ccc}
.grid-6{display:grid;grid-template-columns:repeat(6,1fr);gap:16px}
.image-card{border:1px solid #ddd;padding:8px;font-size:12px;border-radius:6px;background:#fafafa}
.image-card b{display:block;margin-bottom:4px;text-align:center}
.overlay-box{position:relative;width:100%;aspect-ratio:1/1;border:1px solid #aaa;background:#fdfdfd;border-radius:4px}
.overlay-box img{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;cursor:pointer}
.ok{color:green}.error{color:red}
#viewerOverlay{position:fixed;inset:0;background:rgba(0,0,0,.88);display:none;z-index:10000}
#viewerContainer{position:absolute;inset:0;overflow:hidden;cursor:grab}
#viewerImageWrap{position:absolute;top:50%;left:50%;transform-origin:center center}
#viewerClose{position:fixed;top:12px;right:16px;font-size:22px;color:#fff;cursor:pointer;opacity:.85;z-index:10001}
#viewerScaleLabel{position:fixed;top:12px;left:16px;color:#fff;font-size:14px;z-index:10001}
#viewerInfo{position:fixed;right:16px;bottom:25%;color:rgba(255,255,255,.8);font-size:14px;line-height:1.4;text-align:right;z-index:10001}
.viewerArrow{position:fixed;top:50%;transform:translateY(-50%);font-size:48px;color:rgba(255,255,255,.6);cursor:pointer;z-index:10001;user-select:none}
#arrowLeft{left:20px}#arrowRight{right:20px}
</style>
</head>
<body>
<h1>åœ–ç‰‡æª¢æŸ¥å·¥å…·<span class="small-en">Image Inspection Tool</span></h1>
<div id="dropZone">ğŸ‘‰ æ‹–å…¥åœ–ç‰‡ / è³‡æ–™å¤¾ï¼Œæˆ–é»æ­¤é¸å–<span class="small-en">Drag images / folders here, or click to browse</span></div>
<div class="controls">
<button id="openFilesBtn">é¸å–åœ–ç‰‡<span class="small-en">Select Images</span></button>
<button id="openFolderBtn">é¸å–è³‡æ–™å¤¾<span class="small-en">Select Folder</span></button>
<input id="fileInput" type="file" multiple accept="image/*" hidden>
<input id="folderInput" type="file" webkitdirectory hidden>
</div>
<h2>ç–Šåˆæª¢æŸ¥<span class="small-en">Overlay Inspection</span></h2>
<div id="overlayArea"></div>
<div id="viewerOverlay">
  <div id="viewerContainer"><div id="viewerImageWrap"></div></div>
  <div id="viewerClose">âœ•</div>
  <div id="viewerScaleLabel">30%</div>
  <div id="viewerInfo">æ»¾è¼ªï¼šç¸®æ”¾ã€€æ‹–æ›³ï¼šå¹³ç§»<br>â† â†’ï¼šåˆ‡æ› g<br>Escï¼šé—œé–‰
    <div class="small-en">Wheel: Zoom &nbsp; Drag: Pan<br>â† â†’: Switch g &nbsp; Esc: Close</div>
  </div>
  <div id="arrowLeft" class="viewerArrow">â—€</div>
  <div id="arrowRight" class="viewerArrow">â–¶</div>
</div>
<script>
const formatA=/^3([MW])[A-Za-z](\d{8})-ka-(g[1-6])$/i;
const formatB=/^(g[1-6])$/i;
const Gs=["g1","g2","g3","g4","g5","g6"];
let images=[];
function processFile(f){if(!f.type.startsWith("image/"))return;const img=new Image();img.onload=()=>{if(img.width!==4800||img.height!==4800)return;const name=f.name.replace(/\.[^/.]+$/,"");let format=null,g=null,key=null;let m=name.match(formatA);if(m){format="A";g=m[3].toLowerCase();key=name.replace(/-ka-g[1-6]$/i,"")}else if(formatB.test(name)){format="B";g=name.toLowerCase()}
images.push({format,g,key,url:URL.createObjectURL(f)});render()};img.src=URL.createObjectURL(f)}
function render(){overlayArea.innerHTML="";const map={};images.filter(i=>i.format==="A").forEach(i=>{map[i.key]=map[i.key]||{};map[i.key][i.g]=i});Object.entries(map).forEach(([key,gmap])=>{const sec=document.createElement("div");sec.className="section";sec.innerHTML=`<h3>${key}</h3><div class=grid-6></div>`;const grid=sec.querySelector('.grid-6');Gs.forEach(g=>{const card=document.createElement('div');card.className='image-card';card.innerHTML=`<b>${g}</b><div class=overlay-box></div>`;const box=card.querySelector('.overlay-box');const a=gmap[g];const b=images.find(i=>i.format==='B'&&i.g===g);if(a&&b){[b,a].forEach(i=>{const im=document.createElement('img');im.src=i.url;im.onclick=()=>openViewer(key,g);box.appendChild(im)})}
grid.appendChild(card)});overlayArea.appendChild(sec)})}
let curKey=null,curGIndex=0,scale=.3,posX=0,posY=0;
const wrap=document.getElementById('viewerImageWrap');
function openViewer(key,g){curKey=key;curGIndex=Gs.indexOf(g);viewerOverlay.style.display='block';scale=.3;posX=0;posY=0;renderViewer()}
function renderViewer(){wrap.innerHTML='';const g=Gs[curGIndex];const a=images.find(i=>i.format==='A'&&i.key===curKey&&i.g===g);const b=images.find(i=>i.format==='B'&&i.g===g);if(!a||!b)return;[b,a].forEach(i=>{const im=document.createElement('img');im.src=i.url;im.style.position='absolute';im.style.inset=0;im.style.width='100%';im.style.height='100%';im.style.objectFit='contain';wrap.appendChild(im)});updateTransform()}
function updateTransform(){wrap.style.transform=`translate(-50%,-50%) translate(${posX}px,${posY}px) scale(${scale})`;viewerScaleLabel.textContent=Math.round(scale*100)+'%'}
document.getElementById('arrowLeft').onclick=()=>{curGIndex=(curGIndex+5)%6;renderViewer()};
document.getElementById('arrowRight').onclick=()=>{curGIndex=(curGIndex+1)%6;renderViewer()};
viewerOverlay.onwheel=e=>{e.preventDefault();scale=Math.min(5,Math.max(.2,scale+(e.deltaY<0?.1:-.1)));updateTransform()};
document.getElementById('viewerClose').onclick=()=>viewerOverlay.style.display='none';
document.addEventListener('keydown',e=>{if(viewerOverlay.style.display!=='block')return;if(e.key==='ArrowLeft')arrowLeft.onclick();if(e.key==='ArrowRight')arrowRight.onclick();if(e.key==='Escape')viewerOverlay.style.display='none'});
const dropZone=document.getElementById('dropZone');dropZone.onclick=()=>fileInput.click();dropZone.ondragover=e=>{e.preventDefault();dropZone.classList.add('dragover')};dropZone.ondragleave=()=>dropZone.classList.remove('dragover');dropZone.ondrop=e=>{e.preventDefault();dropZone.classList.remove('dragover');[...e.dataTransfer.files].forEach(processFile)};fileInput.onchange=e=>[...e.target.files].forEach(processFile);folderInput.onchange=e=>[...e.target.files].forEach(processFile);
</script>
</body>
</html>
